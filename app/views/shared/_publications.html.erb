<% 
  wall.each do |publication|
  next if publication.publication.user == nil
%>

<!-- le ocultamos informacion privada al usuario -->
<% if visible_for == 'user' && !publication.courses.empty?%>
  <%  next %>
<%end%>

<% if visible_for == 'network' && !publication.courses.empty? && !(current_user.roles.last.id == 1 || current_user.roles.last.id == 4)%>
  <%  if !publication.courses[0].members_in_courses.where(:user_id =>current_user.id, :accepted => true )[0]%>
    <%  next %>
  <%end%>
<%end%>

<%= render partial: 'shared/publications/publication_template', locals: { publication: publication } %>

<script type="text/javascript">
  $('#footer-publication-<%= publication.id %>').on('click',function(e){
    e.preventDefault();
  if(e.target.className === 'icon comments'){ //si quiere ver los comentarios
    // alert('comments!!');
  }
  if(e.target.className === 'icon like'){ //si quiere daler like ;)
    // alert('like!!');
  }
});

  $('#more-comments-<%= publication.id %>').live('click',function(e){
    $.getScript("<%=request.protocol + request.host_with_port%>/home/load_more_comments/<%= publication.id %>");
    return false;
  });
  </script>
  
<%end%>
