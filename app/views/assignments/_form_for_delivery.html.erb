<%
   random_id = "#{random}"
   @labelIdBoxx = "upload-labels-assignments-#{random_id}"
   formId= "form-upload-assignments-#{random_id}"
   class_id_assignment_brief_description = "#{formId}_assignment_brief_description"
   class_id_assignment_title = "#{formId}_assignment_title"
%>

 <% @assignment = Assignment.find_by_user_id_and_delivery_id(current_user.id,@delivery_id) %>

 <% if @assignment.nil? %>
    <% @assignment = Assignment.new %>
 <% else %>
   <% @assignment_id = @assignment.id %>
 <% end %>

<%= form_for(@assignment, :url => assigment_courses_path, :method => :post, :html => { :class => "default-form assignment-delevery-form", :id => formId}) do |f| %>


<% 1.times do
           contents = @assignment.contents.build
  end%>
<div style="min-height:25px;margin-left:10px; width:90%;">
   <%= render :partial => "content/assignments/adding", :locals => {:f => f, :typeo => 'assignment', :acces_to => @assignment, :contents => "contents", :id => formId  }%>
</div>

   <%= f.hidden_field :course_id, :value => cargo.id %>
   <%= f.hidden_field :delivery_id, :value => @delivery_id %>
    <div style="font-size:22px;">
    <%= f.label :Título %><br />
    </div>

    <%= f.text_field :title, :class => "#{formId}_assignment_title" %>
   <div style="float:right;margin-right:280px;width:50px; height:30px; position:relative; margin-top:10px;">
              <%= render partial: 'content/assignments/puts', :locals => {:typeo => 'assignment', :acces_to => @assignment, :id => formId  } %>
              <div style="display:block; float:left; color:#DEDEDE; width:250%; margin-left:30px; margin-top:-40px;">Entrega tu tarea desde Dropbox</div>
     </div>

    <br />
    <div style="font-size:22px;">
       <%= f.label :Descripción %>
    </div>
    <%= f.text_area :brief_description, :cols => 76, :rows => 15, :class => "border_for_text #{formId}_assignment_brief_description " %>
<br />
    <% if @assingment_id.nil? then %>
    <%= f.hidden_field :user_id, :value => current_user.id %>
    <% else %>
    <%= f.hidden_field :user_id, :value => @assignment.user_id %>
    <% end %>

    <%= f.hidden_field :id, :value => @assignment_id if !@assignment_id.nil? %>
     <div id="<%=@labelIdBoxx%>" class="upload-label">      
          <% @assignment.assets.each do |asset|%>            
            <div class="file-mini-upload" id="file-mini-upload-<%=asset.id%>" >
              <input type="hidden" name="files[]" value="<%= asset.id%>">
              <span><%=asset.file%></span>
              <%= link_to "","/assets/"+asset.id.to_s,
            :confirm => '¿Eliminar archivo?', :method => :delete ,:remote => true, :class =>'trash', :onclick => "$(this).parent().remove();"%>
            </div>
          <% end%>  
     </div></br>
     <div style="margin-right:30px;">
    <%= button_tag "Cancelar", :type => 'button', :class => 'input-button', :id => 'cancel-post-form-'+ @delivery_id.to_s %>
    <%= f.submit "Entregar Tarea" %>
    </div>
    <script>
    <%= render :partial => '/assignments/delivery_responce.js.erb', :locals => {:formId => formId}%>
    </script>
<% end %>
<%#= render :partial => "/assignments/delivery_responce" , :locals => {:formId => formId} %>


<%= render :partial => "shared/assets_form", :locals =>{:labelIdBox=>'#'+ @labelIdBoxx, :formId => formId} %>
<div class="notice-file non-margin" style="margin-top:-40px; margin-left:100px; display:block; position:relative;">El límite de peso por archivo es de 8Mb</div>
