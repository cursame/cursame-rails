<%
   random_id = "#{random}"
   @labelIdBox = "upload-labels-#{random_id}"
   formId= "form-upload-delivery-#{random_id}"
%>
<%#if @count_course_iam_member_and_owner != 0%>
<% if !@active_edit %>
  <% @delivery=Delivery.new %>
<% end %>

<%= form_for(@delivery, :remote => true ,:html => { :class => "default-form delivery-form", :multipart => true, :id => formId}) do |f| %>

    <div class="video_help help_use_to_delivery" style="display: none" id="delivery_help">
		<div class="content_video" id="content_video_video_delivery"></div>
    </div>
     
	<% 1.times do contents = @delivery.contents.build end%>
     
<!--este render trae el header de contenidos-->    

<div style="width: 576px; background: transparent;">
<% if @active_edit == false %>
	<%= render :partial => "content/heather_contents", :locals => {:f => f, :typeo => 'delivery', :acces_to => @delivery, :contents => "contents"}%>
    
<%end%>
</div>
        <%= f.hidden_field :network_id, :value => current_network.id %>
        <%= f.hidden_field :user_id, :value => current_user.id %>
        
        <%= f.text_field :title , :placeholder=>'Escribe el tema de la tarea', :style =>'outline-width: 0px;', :class => 'form_fix_title_overlay' %>
        <%#= f.datetime_select :publish_date%>
        <%#= f.datetime_select :end_date%>
		
	<div style="float: right;">
		<span style="display: block; position: relative; float: left; margin-right: 5px; padding-top: 13px;">Fecha entrega</span>
        <%= f.text_field :end_date, :placeholder=>'Fecha de entrega', :style =>'outline-width: 0px;', :class=>"date-input delivery form_fix_date_overlay delivery_end_date", :id => 'end_date_'+random_id, :value=>f.object.end_date  %>
    </div>
    
    <div style="float: left;">
        <span style="display: block; position: relative; float: left; margin-right: 5px; padding-top: 13px;">Fecha publicación</span>
        <%= f.text_field :publish_date, :placeholder=>'Día de publicación', :style =>'outline-width: 0px;', :class=>"date-input delivery form_fix_date_overlay delivery_publish_date", :id => 'publish_date_'+random_id, :value=>f.object.end_date %>
    </div>
    
    <div style="margin-bottom: 10px;">
        <%= f.text_area :description , :rows => 4, :cols => 81, :style =>'outline-width: 0px;', :placeholder=>'Descripción', :class => 'border_for_text' %>
    </div>
    
        <% if @active_edit == false %>
        
		<% 1.times do
		areas_of_evaluations = @delivery.areas_of_evaluations.build
		end%>

        <div class="form_fix_criteria" style="width: 566px; min-height:0px; max-height:200px; overflow:auto; background:#fff;">
        	<%= f.fields_for :areas_of_evaluations do |builder| %>
            <%= render :partial => "areas_of_evaluations/form", :id => 'areas_of_evaluations', :locals => { :f => builder } %>
			<% end %>
        </div>

        <div style="width: 557px; min-height: 40px;">
           <div id="more_nested_evaluation_btn" class="evaluate-btn" style="float:left;">Agregar Criterio</div>
			<div id="<%=@labelIdBox%>" class="upload-label upload-form"></div>
			<%= f.number_field :porcent_of_evaluation, :placeholder=>'Evaluación final', :style =>'width: 113px; float: right; display: inline-block; position: absolute;
margin-left: 292px; height: 21px; outline-width: 0px;', :class=>"percent-input" %>
        </div>


        <%#= f.fields_for :assets do |asset| %>
            <%#= render :partial => "shared/assets_form" %>
        <%#end%>

        <div style="height:30px;">
	        <div class="submit-area"></div>
	        <div style="position: relative; margin-top: 2px; margin-left: 15px; min-height: 31px; float: right;">
			<%= button_tag "Cancelar", :type => 'button', :style =>'position: relative; display: block;', :class=>'input-button cancel-post-form_tab', :onClick=>'removeSliderEvaluation();' , :id => 'cancel-post-form_tab' %>
			<%= f.submit "Publicar", :style =>'position: relative; display: block;', :id => 'comment-post-form'%>
			</div>
			
	        <div style="position: relative; margin-top: 7px; min-height: 31px; float: right;">
        		<%= render :partial => "shared/dropdown", :locals => { :hasPublic => false, :hasCourses => true, :hasGroups => false,:hasUser => false, :defaultText => 'Cursos', :defaultClass => 'course-dd' } %>
			</div>
        </div>
        
        <%else%>
        
        <div style="float:right;">
			<%= f.submit "Guardar Tarea", :id => 'comment-post-form', :class =>"btn"%>        
		</div>
        
        <%end%>
        
		<% if @active_edit == false %>

		<div style="float: left; margin-top: 9px; position: absolute; display: block;">
			<a class="help delivery_help" id="help_delivery"><%= image_tag('help.png')%></a>
		</div>  

	<%end%>
          
          
		<script>
		$('#help_delivery').click(function() {
			$('#delivery_help').toggle('blind', 400);
			if($("#delivery_help").css( 'visibility')=="hidden"){
			$('#content_video_video_delivery').html('');
			}
			else{
			$('#content_video_video_delivery').html('<object width="560" height="280"><param name="movie" value="http://www.youtube.com/v/3UBeivcn3tk?hl=es_ES&amp;version=3&amp;rel=0"></param><param name="allowFullScreen" value="true"></param><param name="allowscriptaccess" value="always"></param><embed src="http://www.youtube.com/v/3UBeivcn3tk?hl=es_ES&amp;version=3&amp;rel=0" type="application/x-shockwave-flash" width="560" height="280" allowscriptaccess="always" allowfullscreen="true"></embed></object>');
			}
		});
		</script>    
    
    <% end %>

<%#end%>


<!--este render trae el list de petición de contenidos-->    
<% if @active_edit == false %>
<div style="float:left; diaplay:block; position:absolute; margin-top:-70px; margin-left:150px; width:300px;"> 
<%= render :partial => "shared/assets_form", :locals =>{:labelIdBox=>'#'+@labelIdBox, :formId => formId} %>
<div style="float:left; margin-left:-295px;"><%= render partial: 'content/list', :locals => {:typeo => 'delivery'} %></div>

</div>
   <%else%></br></br>
    <p style="color:#646464; float:left; margin-top: 10px; padding: 6px;">Por integridad de la actividad no se permiten modificar los archivos, contenidos y criterios después de ser creada le pedimos de la manera mas atenta si necesita agregar alguno de estos elimine la actividad y vuelva a cargarla. </p></br>
    
   <div style="color: #A3A9B5; display: block; width:100%; float:right; margin: 10px 10px 0; position: relative; font-size:20px; padding:5px;">
     <b style="text-align:justify;"> Criterios: </b></br>
    <% @delivery.areas_of_evaluations.each do |d| %>
       <%= d.name%>: <%= d.evaluation_percentage%></br>
    <%end%>
    </div>
<%end%>



<script type="text/javascript">
$(document).ready(function() {
  $( "#publish_date_<%=random_id %>, #end_date_<%=random_id%>" ).datetimepicker({
    inline: false,
    minDate: 0,
    hourMin: 0,
    hourMax: 23,
    controlType: 'select',
    showOtherMonths: true,
    dateFormat: 'dd/mm/yy',
    monthNames: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio','Julio', 'Augosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'],
    dayNamesMin: ['Dom', 'Lun', 'Mar', 'Mie', 'Jue', 'Vie', 'Sab']
  });
});
</script>
